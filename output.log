######## Loading the Datasets

Toatal image size 72 72
######## Split dataset into training and test sets

######## Create TensorFlow Datasets

######## Apply data augmentation

######## Apply class weighting

######## Apply oversampling
######## Apply undersampling
######## compile the model
######## Train the model
input_1 <keras.engine.input_layer.InputLayer object at 0x7efb185f64a0>
conv2d <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb1c7896f0>
conv2d_1 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb1c78b580>
max_pooling2d <keras.layers.pooling.max_pooling2d.MaxPooling2D object at 0x7efb1c7889d0>
conv2d_2 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb18549150>
conv2d_3 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb1854b130>
max_pooling2d_1 <keras.layers.pooling.max_pooling2d.MaxPooling2D object at 0x7efb1c78b5b0>
conv2d_4 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb1854a920>
conv2d_5 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb184f7670>
max_pooling2d_2 <keras.layers.pooling.max_pooling2d.MaxPooling2D object at 0x7efb1854a560>
conv2d_6 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb184f65f0>
conv2d_7 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb184f76a0>
dropout <keras.layers.regularization.dropout.Dropout object at 0x7efb18548fa0>
max_pooling2d_3 <keras.layers.pooling.max_pooling2d.MaxPooling2D object at 0x7efb184f7a60>
conv2d_8 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb1c8dfc10>
conv2d_9 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb1c8df7c0>
dropout_1 <keras.layers.regularization.dropout.Dropout object at 0x7efb184f7730>
up_sampling2d <keras.layers.reshaping.up_sampling2d.UpSampling2D object at 0x7efb186235b0>
conv2d_10 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb18623910>
concatenate <keras.layers.merging.concatenate.Concatenate object at 0x7efb18622d10>
conv2d_11 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb18620220>
conv2d_12 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb18623520>
up_sampling2d_1 <keras.layers.reshaping.up_sampling2d.UpSampling2D object at 0x7efb18622170>
conv2d_13 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb186229b0>
concatenate_1 <keras.layers.merging.concatenate.Concatenate object at 0x7efb185309d0>
conv2d_14 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb18531c60>
conv2d_15 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb18533d60>
up_sampling2d_2 <keras.layers.reshaping.up_sampling2d.UpSampling2D object at 0x7efb185313f0>
conv2d_16 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb18530880>
concatenate_2 <keras.layers.merging.concatenate.Concatenate object at 0x7efb184f79a0>
conv2d_17 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb184f49a0>
conv2d_18 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb1854a9e0>
up_sampling2d_3 <keras.layers.reshaping.up_sampling2d.UpSampling2D object at 0x7efb1c78b250>
conv2d_19 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb1c7880a0>
concatenate_3 <keras.layers.merging.concatenate.Concatenate object at 0x7efb1c7d5780>
conv2d_20 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb1c7d4b50>
conv2d_21 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb1c7d7c40>
conv2d_22 <keras.layers.convolutional.conv2d.Conv2D object at 0x7efb1c7d5a20>
Epoch 1/10
1/8 [==>...........................] - ETA: 1:10 - loss: 1.7799 - accuracy: 0.23992/8 [======>.......................] - ETA: 35s - loss: 1.7705 - accuracy: 0.5703 3/8 [==========>...................] - ETA: 29s - loss: 1.7598 - accuracy: 0.70994/8 [==============>...............] - ETA: 23s - loss: 1.7524 - accuracy: 0.78215/8 [=================>............] - ETA: 17s - loss: 1.7401 - accuracy: 0.82576/8 [=====================>........] - ETA: 11s - loss: 1.7189 - accuracy: 0.85477/8 [=========================>....] - ETA: 5s - loss: 1.6814 - accuracy: 0.8755 8/8 [==============================] - ETA: 0s - loss: 1.6734 - accuracy: 0.87778/8 [==============================] - 46s 5s/step - loss: 1.6734 - accuracy: 0.8777
Epoch 2/10
1/8 [==>...........................] - ETA: 40s - loss: 0.4101 - accuracy: 1.00002/8 [======>.......................] - ETA: 34s - loss: 0.2302 - accuracy: 1.00003/8 [==========>...................] - ETA: 29s - loss: 0.1601 - accuracy: 1.00004/8 [==============>...............] - ETA: 23s - loss: 0.1213 - accuracy: 1.00005/8 [=================>............] - ETA: 17s - loss: 0.0973 - accuracy: 1.00006/8 [=====================>........] - ETA: 11s - loss: 0.0811 - accuracy: 1.00007/8 [=========================>....] - ETA: 5s - loss: 0.0695 - accuracy: 1.0000 8/8 [==============================] - ETA: 0s - loss: 0.0683 - accuracy: 1.00008/8 [==============================] - 41s 5s/step - loss: 0.0683 - accuracy: 1.0000
Epoch 3/10
1/8 [==>...........................] - ETA: 41s - loss: 6.9150e-07 - accuracy: 1.00002/8 [======>.......................] - ETA: 35s - loss: 3.4718e-07 - accuracy: 1.00003/8 [==========>...................] - ETA: 29s - loss: 2.6098e-07 - accuracy: 1.00004/8 [==============>...............] - ETA: 23s - loss: 2.0598e-07 - accuracy: 1.00005/8 [=================>............] - ETA: 17s - loss: 1.6733e-07 - accuracy: 1.00006/8 [=====================>........] - ETA: 11s - loss: 1.4158e-07 - accuracy: 1.00007/8 [=========================>....] - ETA: 5s - loss: 1.2136e-07 - accuracy: 1.0000 8/8 [==============================] - ETA: 0s - loss: 1.1923e-07 - accuracy: 1.00008/8 [==============================] - 42s 5s/step - loss: 1.1923e-07 - accuracy: 1.0000
Epoch 4/10
1/8 [==>...........................] - ETA: 41s - loss: 0.0000e+00 - accuracy: 1.00002/8 [======>.......................] - ETA: 34s - loss: 0.0000e+00 - accuracy: 1.00003/8 [==========>...................] - ETA: 28s - loss: 0.0000e+00 - accuracy: 1.00004/8 [==============>...............] - ETA: 23s - loss: 0.0000e+00 - accuracy: 1.00005/8 [=================>............] - ETA: 17s - loss: 0.0000e+00 - accuracy: 1.00006/8 [=====================>........] - ETA: 11s - loss: 0.0000e+00 - accuracy: 1.00007/8 [=========================>....] - ETA: 5s - loss: 0.0000e+00 - accuracy: 1.0000 8/8 [==============================] - ETA: 0s - loss: 0.0000e+00 - accuracy: 1.00008/8 [==============================] - 42s 5s/step - loss: 0.0000e+00 - accuracy: 1.0000
Epoch 5/10
1/8 [==>...........................] - ETA: 42s - loss: 0.0000e+00 - accuracy: 1.00002/8 [======>.......................] - ETA: 34s - loss: 0.0000e+00 - accuracy: 1.00003/8 [==========>...................] - ETA: 28s - loss: 0.0000e+00 - accuracy: 1.00004/8 [==============>...............] - ETA: 23s - loss: 0.0000e+00 - accuracy: 1.00005/8 [=================>............] - ETA: 17s - loss: 0.0000e+00 - accuracy: 1.00006/8 [=====================>........] - ETA: 11s - loss: 0.0000e+00 - accuracy: 1.00007/8 [=========================>....] - ETA: 5s - loss: 0.0000e+00 - accuracy: 1.0000 8/8 [==============================] - ETA: 0s - loss: 0.0000e+00 - accuracy: 1.00008/8 [==============================] - 42s 5s/step - loss: 0.0000e+00 - accuracy: 1.0000
Epoch 6/10
1/8 [==>...........................] - ETA: 42s - loss: 0.0000e+00 - accuracy: 1.00002/8 [======>.......................] - ETA: 34s - loss: 0.0000e+00 - accuracy: 1.00003/8 [==========>...................] - ETA: 28s - loss: 0.0000e+00 - accuracy: 1.00004/8 [==============>...............] - ETA: 23s - loss: 0.0000e+00 - accuracy: 1.00005/8 [=================>............] - ETA: 17s - loss: 0.0000e+00 - accuracy: 1.00006/8 [=====================>........] - ETA: 11s - loss: 0.0000e+00 - accuracy: 1.00007/8 [=========================>....] - ETA: 5s - loss: 0.0000e+00 - accuracy: 1.0000 8/8 [==============================] - ETA: 0s - loss: 0.0000e+00 - accuracy: 1.00008/8 [==============================] - 42s 5s/step - loss: 0.0000e+00 - accuracy: 1.0000
Epoch 7/10
1/8 [==>...........................] - ETA: 41s - loss: 0.0000e+00 - accuracy: 1.00002/8 [======>.......................] - ETA: 34s - loss: 0.0000e+00 - accuracy: 1.00003/8 [==========>...................] - ETA: 28s - loss: 0.0000e+00 - accuracy: 1.00004/8 [==============>...............] - ETA: 23s - loss: 0.0000e+00 - accuracy: 1.00005/8 [=================>............] - ETA: 17s - loss: 0.0000e+00 - accuracy: 1.00006/8 [=====================>........] - ETA: 11s - loss: 0.0000e+00 - accuracy: 1.00007/8 [=========================>....] - ETA: 5s - loss: 0.0000e+00 - accuracy: 1.0000 8/8 [==============================] - ETA: 0s - loss: 0.0000e+00 - accuracy: 1.00008/8 [==============================] - 42s 5s/step - loss: 0.0000e+00 - accuracy: 1.0000
Epoch 8/10
1/8 [==>...........................] - ETA: 41s - loss: 0.0000e+00 - accuracy: 1.00002/8 [======>.......................] - ETA: 34s - loss: 0.0000e+00 - accuracy: 1.00003/8 [==========>...................] - ETA: 28s - loss: 0.0000e+00 - accuracy: 1.00004/8 [==============>...............] - ETA: 23s - loss: 0.0000e+00 - accuracy: 1.00005/8 [=================>............] - ETA: 17s - loss: 0.0000e+00 - accuracy: 1.00006/8 [=====================>........] - ETA: 11s - loss: 0.0000e+00 - accuracy: 1.00007/8 [=========================>....] - ETA: 5s - loss: 0.0000e+00 - accuracy: 1.0000 8/8 [==============================] - ETA: 0s - loss: 0.0000e+00 - accuracy: 1.00008/8 [==============================] - 42s 5s/step - loss: 0.0000e+00 - accuracy: 1.0000
Epoch 9/10
1/8 [==>...........................] - ETA: 42s - loss: 0.0000e+00 - accuracy: 1.00002/8 [======>.......................] - ETA: 34s - loss: 0.0000e+00 - accuracy: 1.00003/8 [==========>...................] - ETA: 29s - loss: 0.0000e+00 - accuracy: 1.00004/8 [==============>...............] - ETA: 23s - loss: 0.0000e+00 - accuracy: 1.00005/8 [=================>............] - ETA: 17s - loss: 0.0000e+00 - accuracy: 1.00006/8 [=====================>........] - ETA: 11s - loss: 0.0000e+00 - accuracy: 1.00007/8 [=========================>....] - ETA: 5s - loss: 0.0000e+00 - accuracy: 1.0000 8/8 [==============================] - ETA: 0s - loss: 0.0000e+00 - accuracy: 1.00008/8 [==============================] - 42s 5s/step - loss: 0.0000e+00 - accuracy: 1.0000
Epoch 10/10
1/8 [==>...........................] - ETA: 41s - loss: 0.0000e+00 - accuracy: 1.00002/8 [======>.......................] - ETA: 34s - loss: 0.0000e+00 - accuracy: 1.00003/8 [==========>...................] - ETA: 28s - loss: 0.0000e+00 - accuracy: 1.00004/8 [==============>...............] - ETA: 22s - loss: 0.0000e+00 - accuracy: 1.00005/8 [=================>............] - ETA: 17s - loss: 0.0000e+00 - accuracy: 1.00006/8 [=====================>........] - ETA: 11s - loss: 0.0000e+00 - accuracy: 1.00007/8 [=========================>....] - ETA: 5s - loss: 0.0000e+00 - accuracy: 1.0000 8/8 [==============================] - ETA: 0s - loss: 0.0000e+00 - accuracy: 1.00008/8 [==============================] - 42s 5s/step - loss: 0.0000e+00 - accuracy: 1.0000
Model saved to /home/dyadav/repos/counter_project/data_analysis/data/deepak_codeunet_model1.h5
######## Evaluate the model
1/2 [==============>...............] - ETA: 3s - loss: 0.0000e+00 - accuracy: 1.00002/2 [==============================] - ETA: 0s - loss: 0.0000e+00 - accuracy: 1.00002/2 [==============================] - 5s 2s/step - loss: 0.0000e+00 - accuracy: 1.0000
Test Loss: 0.0
Test Accuracy: 1.0
######## Visualize predictions
1/2 [==============>...............] - ETA: 2s2/2 [==============================] - ETA: 0s2/2 [==============================] - 5s 2s/step
Image shape before reshaping: (8, 256, 256, 3)
Skipping image with incorrect shape: (8, 256, 256, 3)
Image shape before reshaping: (7, 256, 256, 3)
Skipping image with incorrect shape: (7, 256, 256, 3)
